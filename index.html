<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Tower Battle PoC</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --bg-0: #09111f;
        --bg-1: #101a2b;
        --bg-2: #1a2740;
        --surface: rgba(15, 24, 38, 0.84);
        --surface-strong: rgba(19, 29, 45, 0.95);
        --stroke: rgba(181, 210, 255, 0.2);
        --text: #edf4ff;
        --text-muted: rgba(226, 238, 255, 0.78);
        --accent: #2dd4bf;
        --accent-strong: #14b8a6;
        --campaign-accent: #2b6cee;
        --campaign-accent-strong: #1e4bc9;
        --campaign-accent-soft: rgba(43, 108, 238, 0.2);
        --danger: #f87171;
        --shadow: 0 20px 42px rgba(2, 9, 19, 0.5);
      }

      body {
        margin: 0;
        min-height: 100vh;
        overflow: hidden;
        color: var(--text);
        font-family: "Avenir Next", "Trebuchet MS", "Segoe UI", sans-serif;
        background:
          radial-gradient(1000px 600px at 15% -10%, rgba(45, 212, 191, 0.15), transparent),
          radial-gradient(900px 560px at 100% 0%, rgba(56, 189, 248, 0.15), transparent),
          linear-gradient(145deg, var(--bg-0), var(--bg-1) 40%, var(--bg-2) 100%);
      }
      #screenRoot {
        position: fixed;
        inset: 0;
        z-index: 12;
        pointer-events: none;
      }
      #gameCanvas {
        position: fixed;
        inset: 0;
        display: block;
      }

      .menu-panel {
        width: min(92vw, 760px);
        display: flex;
        flex-direction: column;
        max-height: min(92vh, 940px);
      }

      .menu-panel-wide {
        width: min(94vw, 940px);
      }

      .title-panel {
        width: min(90vw, 700px);
      }

      .splash-centered {
        padding: 0;
        align-items: stretch;
        overflow: hidden;
      }

      .splash-shell {
        width: 100%;
        height: 100%;
        min-height: 100vh;
        display: grid;
        grid-template-rows: 1fr auto;
        align-items: center;
        justify-items: center;
        padding: clamp(16px, 2.2vh, 24px) clamp(16px, 2.8vw, 32px) clamp(20px, 3.2vh, 34px);
        position: relative;
        overflow: hidden;
        isolation: isolate;
        font-family: "Space Grotesk", "Avenir Next", "Trebuchet MS", "Segoe UI", sans-serif;
        background:
          linear-gradient(to right, rgba(43, 108, 238, 0.08) 1px, transparent 1px),
          linear-gradient(to bottom, rgba(43, 108, 238, 0.08) 1px, transparent 1px),
          radial-gradient(900px 500px at 16% -8%, rgba(43, 108, 238, 0.17), transparent),
          radial-gradient(780px 540px at 98% 102%, rgba(56, 189, 248, 0.14), transparent),
          linear-gradient(158deg, rgba(12, 21, 37, 0.97), rgba(10, 17, 31, 0.99));
        background-size: 40px 40px, 40px 40px, auto, auto, auto;
      }

      .splash-shell::before {
        content: "";
        position: absolute;
        inset: 0;
        pointer-events: none;
        background:
          radial-gradient(circle at 50% 30%, rgba(43, 108, 238, 0.12), transparent 30%),
          linear-gradient(180deg, rgba(7, 11, 20, 0.16), rgba(7, 11, 20, 0.5));
      }

      .splash-shell::after {
        content: "";
        position: absolute;
        inset: auto -8% -34% -8%;
        height: 58%;
        pointer-events: none;
        background: radial-gradient(closest-side, rgba(43, 108, 238, 0.18), transparent);
        filter: blur(34px);
        z-index: 0;
      }

      .splash-hero {
        width: min(430px, 100%);
        display: grid;
        justify-items: center;
        align-content: center;
        gap: 24px;
        z-index: 1;
      }

      .splash-emblem-wrap {
        position: relative;
        width: 170px;
        height: 170px;
      }

      .splash-emblem-glow {
        position: absolute;
        inset: 0;
        border-radius: 22px;
        background: rgba(43, 108, 238, 0.28);
        filter: blur(28px);
        transform: scale(1.26);
      }

      .splash-emblem {
        position: relative;
        width: 100%;
        height: 100%;
        border-radius: 20px;
        border: 2px solid rgba(106, 162, 255, 0.55);
        background: linear-gradient(160deg, rgba(17, 30, 53, 0.84), rgba(8, 17, 31, 0.9));
        box-shadow: 0 16px 36px rgba(2, 10, 22, 0.52);
        display: grid;
        place-items: center;
      }

      .splash-icon {
        display: grid;
        justify-items: center;
        align-content: center;
      }

      .splash-icon-top {
        width: 64px;
        height: 10px;
        border-radius: 3px 3px 2px 2px;
        background: linear-gradient(90deg, #4d8fff, #2b6cee);
        margin-bottom: 4px;
      }

      .splash-icon-body {
        width: 46px;
        height: 78px;
        background: linear-gradient(180deg, rgba(67, 128, 255, 0.96), rgba(43, 108, 238, 0.82));
        display: grid;
        justify-items: center;
        align-content: space-between;
        padding: 10px 0 12px;
      }

      .splash-icon-eye {
        width: 14px;
        height: 14px;
        border-radius: 999px;
        background: rgba(8, 16, 30, 0.9);
      }

      .splash-icon-slot {
        width: 26px;
        height: 4px;
        border-radius: 999px;
        background: rgba(6, 14, 27, 0.36);
      }

      .splash-icon-bottom {
        width: 78px;
        height: 11px;
        border-radius: 2px 2px 4px 4px;
        background: linear-gradient(90deg, #2b6cee, #5f9bff);
        margin-top: 4px;
      }

      .splash-title-wrap {
        text-align: center;
        display: grid;
        gap: 10px;
      }

      .splash-title {
        margin: 0;
        font-size: clamp(2.2rem, 8vw, 4rem);
        line-height: 0.9;
        letter-spacing: -0.03em;
        text-transform: uppercase;
      }

      .splash-title span {
        color: var(--campaign-accent);
      }

      .splash-subtitle {
        margin: 0;
        font-size: 0.76rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.2em;
        color: rgba(186, 206, 239, 0.68);
      }

      .splash-footer {
        width: min(390px, 100%);
        display: grid;
        gap: 0;
        justify-items: center;
        z-index: 1;
      }

      .splash-cta {
        display: grid;
        gap: 8px;
        margin-top: 64px;
        justify-items: center;
      }

      .splash-cta-text {
        margin: 0;
        font-size: clamp(1.2rem, 2.8vw, 1.85rem);
        font-weight: 700;
        letter-spacing: 0.03em;
        text-transform: uppercase;
        color: rgba(219, 233, 255, 0.92);
        text-shadow: 0 0 22px rgba(82, 160, 255, 0.36);
        animation: splashPulse 1.6s ease-in-out infinite;
      }

      .splash-cta-dot {
        width: 8px;
        height: 8px;
        border-radius: 999px;
        background: var(--campaign-accent);
      }

      .splash-home-indicator {
        width: 116px;
        height: 4px;
        border-radius: 999px;
        background: rgba(118, 148, 201, 0.36);
      }

      .panel,
      .ui-panel {
        pointer-events: auto;
        background: var(--surface);
        border: 1px solid var(--stroke);
        border-radius: 16px;
        padding: 18px;
        box-shadow: var(--shadow);
        backdrop-filter: blur(14px);
        max-height: min(90vh, 920px);
      }

      .ui-panel-header {
        display: grid;
        grid-template-columns: 1fr auto;
        gap: 8px;
        align-items: center;
        margin-bottom: 8px;
      }

      .ui-heading {
        margin: 0;
        font-size: clamp(1.1rem, 2.2vw, 1.7rem);
        letter-spacing: 0.02em;
      }

      .ui-subheading {
        margin: 0;
        grid-column: 1 / -1;
        color: var(--text-muted);
        font-size: 0.92rem;
      }

      .ui-card {
        display: grid;
        gap: 8px;
        border-radius: 12px;
        border: 1px solid rgba(181, 210, 255, 0.17);
        background: rgba(13, 22, 34, 0.74);
        padding: 12px;
      }

      .ui-card-title {
        margin: 0 0 2px;
        font-size: 0.96rem;
        color: var(--text-muted);
        text-transform: uppercase;
        letter-spacing: 0.08em;
      }

      .centered {
        position: absolute;
        inset: 0;
        display: grid;
        justify-items: center;
        align-items: start;
        padding: 18px;
        overflow-y: auto;
        pointer-events: auto;
      }
      .menu-body {
        flex: 1;
        min-height: 0;
        overflow: hidden;
        display: grid;
      }
      .menu-body-scroll {
        min-height: 0;
        overflow-y: auto;
        display: grid;
        gap: 12px;
        padding-right: 6px;
      }
      .menu-footer {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        align-items: center;
      }
      .list {
        display: grid;
        gap: 10px;
      }
      .meta-row {
        display: grid;
        grid-template-columns: 1fr auto;
        gap: 12px;
        align-items: center;
      }

      .campaign-main-centered {
        align-items: center;
        padding: clamp(16px, 3vh, 28px);
        overflow: hidden;
        isolation: isolate;
        font-family: "Space Grotesk", "Avenir Next", "Trebuchet MS", "Segoe UI", sans-serif;
        background:
          linear-gradient(to right, rgba(43, 108, 238, 0.08) 1px, transparent 1px),
          linear-gradient(to bottom, rgba(43, 108, 238, 0.08) 1px, transparent 1px),
          radial-gradient(900px 500px at 16% -8%, rgba(43, 108, 238, 0.17), transparent),
          radial-gradient(780px 540px at 98% 102%, rgba(56, 189, 248, 0.14), transparent),
          linear-gradient(158deg, rgba(12, 21, 37, 0.97), rgba(10, 17, 31, 0.99));
        background-size: 40px 40px, 40px 40px, auto, auto, auto;
      }

      .campaign-main-centered::before {
        content: "";
        position: absolute;
        inset: 0;
        pointer-events: none;
        background:
          radial-gradient(circle at 50% 30%, rgba(43, 108, 238, 0.12), transparent 30%),
          linear-gradient(180deg, rgba(7, 11, 20, 0.16), rgba(7, 11, 20, 0.5));
      }

      .campaign-main-centered::after {
        content: "";
        position: absolute;
        inset: auto -8% -34% -8%;
        height: 58%;
        pointer-events: none;
        background: radial-gradient(closest-side, rgba(43, 108, 238, 0.18), transparent);
        filter: blur(34px);
        z-index: 0;
      }

      .campaign-main-layout {
        width: min(92vw, 420px);
        display: grid;
        justify-items: center;
        gap: clamp(18px, 4vh, 34px);
        position: relative;
        z-index: 1;
      }

      .campaign-main-menu {
        width: 100%;
        display: grid;
        gap: 12px;
        padding: 14px;
        background:
          radial-gradient(480px 220px at 18% -5%, rgba(43, 108, 238, 0.2), transparent),
          radial-gradient(420px 240px at 100% 100%, rgba(79, 70, 229, 0.18), transparent),
          linear-gradient(165deg, rgba(16, 26, 43, 0.92), rgba(10, 18, 34, 0.96));
      }

      .campaign-overline {
        margin: 0;
        text-transform: uppercase;
        font-size: 0.7rem;
        letter-spacing: 0.16em;
        color: rgba(203, 218, 247, 0.75);
      }

      .campaign-main-heading {
        margin: 0;
        font-size: clamp(1.8rem, 5vw, 2.5rem);
        line-height: 0.95;
        letter-spacing: 0.02em;
        text-align: center;
        text-transform: uppercase;
      }

      .campaign-main-heading span {
        color: #7eb0ff;
      }

      .campaign-main-title {
        text-align: center;
      }

      .campaign-main-actions {
        display: grid;
        gap: 10px;
      }

      .campaign-main-action {
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: space-between;
        text-align: left;
        min-height: 52px;
        border-radius: 12px;
        padding: 12px 14px;
        font-size: 0.96rem;
      }

      .campaign-main-action.ui-button-primary {
        background: linear-gradient(140deg, var(--campaign-accent), var(--campaign-accent-strong));
        border-color: rgba(135, 177, 255, 0.58);
        color: #f8fbff;
        box-shadow: 0 10px 24px rgba(19, 64, 168, 0.4);
      }

      .campaign-main-action.ui-button-secondary {
        background: rgba(90, 121, 173, 0.2);
        border-color: rgba(158, 193, 255, 0.24);
      }

      .campaign-info-pill {
        display: grid;
        gap: 2px;
        padding: 8px 10px;
        border-radius: 10px;
        border: 1px solid rgba(148, 186, 255, 0.2);
        background: rgba(12, 22, 37, 0.65);
      }

      .campaign-info-pill-label {
        font-size: 0.66rem;
        letter-spacing: 0.12em;
        text-transform: uppercase;
        color: rgba(209, 224, 247, 0.7);
      }

      .campaign-info-pill-value {
        font-size: 0.95rem;
        color: #eff5ff;
      }

      .campaign-shell {
        display: grid;
        gap: 12px;
        background:
          radial-gradient(420px 220px at 20% -8%, rgba(43, 108, 238, 0.15), transparent),
          linear-gradient(160deg, rgba(11, 19, 32, 0.95), rgba(8, 15, 27, 0.95));
      }

      .campaign-profile-shell {
        width: min(92vw, 900px);
      }

      .campaign-profile-card {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(170px, 1fr));
        gap: 9px;
      }

      .campaign-meta-shell {
        width: min(95vw, 1260px);
      }

      .campaign-meta-tree-row {
        display: grid;
        grid-template-columns: repeat(3, minmax(280px, 1fr));
        gap: 12px;
        overflow-x: auto;
        padding-bottom: 4px;
      }

      .campaign-meta-tree-card {
        border: 1px solid var(--meta-accent-soft, rgba(148, 186, 255, 0.22));
        border-radius: 14px;
        background:
          radial-gradient(280px 130px at 0% -20%, var(--meta-accent-soft, rgba(148, 186, 255, 0.2)), transparent),
          linear-gradient(160deg, rgba(11, 21, 35, 0.9), rgba(8, 16, 30, 0.9));
        padding: 11px;
        display: grid;
        gap: 11px;
        position: relative;
        overflow: hidden;
        box-shadow: 0 12px 30px rgba(2, 10, 22, 0.45);
      }

      .campaign-meta-tree-card::after {
        content: "";
        position: absolute;
        inset: 0;
        border-radius: inherit;
        border: 1px solid color-mix(in srgb, var(--meta-accent, #6ea8ff) 45%, transparent);
        opacity: 0.28;
        pointer-events: none;
      }

      .campaign-meta-tree-header {
        display: grid;
        gap: 8px;
      }

      .campaign-meta-tree-top {
        display: grid;
        grid-template-columns: auto 1fr;
        gap: 10px;
        align-items: center;
      }

      .campaign-meta-tree-emblem {
        width: 34px;
        height: 34px;
        border-radius: 10px;
        display: grid;
        place-items: center;
        font-size: 0.76rem;
        font-weight: 800;
        letter-spacing: 0.08em;
        color: #f3f8ff;
        background: linear-gradient(150deg, var(--meta-accent, #6ea8ff), rgba(9, 16, 30, 0.95));
        box-shadow: 0 0 20px var(--meta-accent-halo, rgba(110, 168, 255, 0.35));
      }

      .campaign-meta-tree-title {
        margin: 0;
        font-size: 0.94rem;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        color: rgba(229, 240, 255, 0.96);
      }

      .campaign-meta-tree-subtitle {
        margin: 0;
        font-size: 0.72rem;
        color: rgba(196, 214, 243, 0.78);
      }

      .campaign-meta-tree-summary {
        display: flex;
        align-items: center;
        justify-content: space-between;
      }

      .campaign-meta-tree-summary-copy {
        font-size: 0.72rem;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        color: rgba(205, 222, 248, 0.74);
      }

      .campaign-meta-tree-rank {
        font-size: 0.8rem;
        font-weight: 700;
        color: color-mix(in srgb, var(--meta-accent, #6ea8ff) 78%, #ffffff 22%);
      }

      .campaign-meta-tree-progress {
        height: 7px;
        border-radius: 999px;
        background: rgba(91, 114, 154, 0.32);
        overflow: hidden;
      }

      .campaign-meta-tree-progress-fill {
        height: 100%;
        border-radius: inherit;
        background: linear-gradient(90deg, color-mix(in srgb, var(--meta-accent, #6ea8ff) 82%, #ffffff 18%), var(--meta-accent, #6ea8ff));
        box-shadow: 0 0 12px var(--meta-accent-halo, rgba(110, 168, 255, 0.35));
      }

      .campaign-meta-node-scroll {
        padding-right: 4px;
      }

      .campaign-meta-node-list {
        display: grid;
        gap: 8px;
      }

      .campaign-meta-node-row {
        border: 1px solid rgba(148, 186, 255, 0.16);
        border-radius: 12px;
        background: rgba(15, 27, 43, 0.74);
        padding: 9px;
        display: grid;
        gap: 8px;
        transition: border-color 140ms ease, transform 140ms ease, background-color 140ms ease;
      }

      .campaign-meta-node-row.is-affordable {
        border-color: color-mix(in srgb, var(--meta-accent, #6ea8ff) 55%, transparent);
        background: rgba(19, 34, 55, 0.82);
      }

      .campaign-meta-node-row.is-maxed {
        border-color: rgba(74, 222, 128, 0.35);
        background: rgba(17, 35, 34, 0.68);
      }

      .campaign-meta-node-copy {
        display: grid;
        gap: 6px;
      }

      .campaign-meta-node-head {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 8px;
      }

      .campaign-meta-node-name {
        margin: 0;
        font-size: 0.82rem;
        font-weight: 700;
        letter-spacing: 0.01em;
        color: rgba(232, 242, 255, 0.95);
      }

      .campaign-meta-rank-pill {
        border-radius: 999px;
        padding: 2px 8px;
        font-size: 0.64rem;
        font-weight: 700;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        color: color-mix(in srgb, var(--meta-accent, #6ea8ff) 85%, #ffffff 15%);
        border: 1px solid color-mix(in srgb, var(--meta-accent, #6ea8ff) 45%, transparent);
        background: color-mix(in srgb, var(--meta-accent-soft, rgba(110, 168, 255, 0.24)) 75%, rgba(14, 24, 38, 0.8));
      }

      .campaign-meta-node-details {
        font-size: 0.74rem;
        line-height: 1.35;
        color: rgba(189, 206, 233, 0.8);
      }

      .campaign-meta-node-prereqs {
        display: flex;
        flex-wrap: wrap;
        gap: 5px;
      }

      .campaign-meta-prereq-pill {
        border-radius: 999px;
        padding: 2px 7px;
        font-size: 0.62rem;
        letter-spacing: 0.06em;
        text-transform: uppercase;
        color: rgba(203, 218, 245, 0.78);
        border: 1px solid rgba(148, 186, 255, 0.18);
        background: rgba(44, 66, 99, 0.33);
      }

      .campaign-meta-node-progress {
        height: 5px;
        border-radius: 999px;
        background: rgba(88, 111, 151, 0.3);
        overflow: hidden;
      }

      .campaign-meta-node-progress-fill {
        height: 100%;
        border-radius: inherit;
        background: linear-gradient(90deg, color-mix(in srgb, var(--meta-accent, #6ea8ff) 72%, #ffffff 28%), var(--meta-accent, #6ea8ff));
      }

      .campaign-meta-buy-btn {
        width: 100%;
        min-height: 38px;
        border-radius: 10px;
        font-size: 0.78rem;
        letter-spacing: 0.03em;
        text-transform: uppercase;
        font-weight: 700;
      }

      .campaign-generator-shell {
        width: min(94vw, 1100px);
      }

      .campaign-generator-controls {
        border: 1px solid rgba(148, 186, 255, 0.24);
        border-radius: 12px;
        padding: 12px;
        background: rgba(12, 24, 40, 0.72);
        display: grid;
        gap: 10px;
      }

      .campaign-generator-size-row {
        border: 1px solid rgba(148, 186, 255, 0.2);
        border-radius: 10px;
        padding: 8px 10px;
      }

      .campaign-generator-size-label {
        font-size: 0.78rem;
        letter-spacing: 0.1em;
        text-transform: uppercase;
        color: rgba(206, 222, 246, 0.78);
      }

      .campaign-generator-size-select {
        background: rgba(10, 18, 31, 0.85);
        color: rgba(235, 243, 255, 0.95);
        border: 1px solid rgba(148, 186, 255, 0.22);
        border-radius: 8px;
        padding: 6px 8px;
      }

      .campaign-generator-preview-card {
        border: 1px solid rgba(148, 186, 255, 0.24);
        border-radius: 12px;
        padding: 12px;
        background:
          radial-gradient(360px 180px at 15% -12%, rgba(43, 108, 238, 0.2), transparent),
          rgba(8, 18, 33, 0.85);
        display: grid;
        gap: 10px;
      }

      .campaign-generator-preview-title {
        margin: 0;
        font-size: clamp(1rem, 2vw, 1.24rem);
      }

      .campaign-generator-preview-subtitle {
        margin: 0;
        font-size: 0.78rem;
        color: rgba(205, 220, 245, 0.8);
      }

      .campaign-generator-preview-stats {
        margin: 0;
        font-size: 0.8rem;
        color: rgba(206, 221, 247, 0.8);
      }

      .campaign-screen-header {
        display: grid;
        gap: 4px;
      }

      .campaign-screen-title {
        margin: 0;
        font-size: clamp(1.2rem, 2.7vw, 1.8rem);
        letter-spacing: 0.01em;
      }

      .campaign-progress-card {
        display: grid;
        gap: 10px;
        border: 1px solid rgba(148, 186, 255, 0.24);
        border-radius: 12px;
        padding: 12px;
        background: rgba(13, 25, 42, 0.75);
      }

      .campaign-progress-top {
        display: flex;
        justify-content: space-between;
        gap: 10px;
        align-items: center;
      }

      .campaign-progress-title {
        margin: 0;
        font-size: 0.88rem;
        text-transform: uppercase;
        letter-spacing: 0.09em;
        color: rgba(204, 221, 250, 0.84);
      }

      .campaign-progress-subtitle {
        margin: 4px 0 0;
        font-size: 0.83rem;
        color: rgba(213, 227, 250, 0.72);
      }

      .campaign-progress-value {
        display: grid;
        justify-items: end;
        font-size: 1.3rem;
        font-weight: 700;
        color: #deebff;
      }

      .campaign-progress-value-label {
        font-size: 0.65rem;
        letter-spacing: 0.1em;
        text-transform: uppercase;
        color: rgba(203, 217, 245, 0.68);
      }

      .campaign-progress-track {
        height: 8px;
        border-radius: 999px;
        background: rgba(119, 151, 207, 0.3);
        overflow: hidden;
      }

      .campaign-progress-fill {
        height: 100%;
        border-radius: inherit;
        background: linear-gradient(90deg, #4f8cff, #2b6cee);
        box-shadow: 0 0 14px rgba(43, 108, 238, 0.5);
      }

      .campaign-status-pill {
        display: inline-flex;
        align-items: center;
        width: fit-content;
        border-radius: 999px;
        padding: 4px 9px;
        font-size: 0.62rem;
        font-weight: 700;
        letter-spacing: 0.09em;
        text-transform: uppercase;
        border: 1px solid transparent;
      }

      .campaign-status-pill.is-open {
        color: #dbeafe;
        border-color: rgba(147, 197, 253, 0.5);
        background: rgba(59, 130, 246, 0.18);
      }

      .campaign-status-pill.is-completed {
        color: #d1fae5;
        border-color: rgba(74, 222, 128, 0.45);
        background: rgba(34, 197, 94, 0.2);
      }

      .campaign-status-pill.is-locked {
        color: rgba(198, 210, 233, 0.76);
        border-color: rgba(148, 163, 184, 0.28);
        background: rgba(71, 85, 105, 0.26);
      }

      .campaign-stage-rail {
        display: grid;
        grid-auto-flow: column;
        grid-auto-columns: minmax(250px, 1fr);
        gap: 12px;
        overflow-x: auto;
        padding-bottom: 6px;
      }

      .campaign-stage-card {
        border-radius: 14px;
        border: 1px solid rgba(148, 186, 255, 0.18);
        background: rgba(9, 19, 33, 0.78);
        overflow: hidden;
        display: grid;
        min-height: 290px;
        grid-template-rows: 1.15fr 1fr;
      }

      .campaign-stage-card.is-locked {
        opacity: 0.7;
      }

      .campaign-stage-card.is-completed {
        border-color: rgba(110, 231, 183, 0.35);
      }

      .campaign-stage-preview {
        display: flex;
        flex-direction: column;
        justify-content: flex-end;
        gap: 6px;
        padding: 12px;
        border-bottom: 1px solid rgba(148, 186, 255, 0.2);
        background: var(--campaign-stage-gradient, linear-gradient(145deg, rgba(43, 108, 238, 0.45), rgba(16, 28, 54, 0.9)));
      }

      .campaign-stage-title {
        margin: 0;
        font-size: 1.15rem;
      }

      .campaign-stage-subtitle {
        margin: 0;
        font-size: 0.78rem;
        color: rgba(223, 235, 255, 0.84);
      }

      .campaign-stage-body {
        display: grid;
        gap: 12px;
        align-content: space-between;
        padding: 12px;
      }

      .campaign-stage-detail {
        margin: 0;
        font-size: 0.83rem;
        line-height: 1.4;
        color: rgba(213, 226, 248, 0.74);
      }

      .campaign-stage-action {
        width: 100%;
        min-height: 42px;
      }

      .campaign-level-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 12px;
      }

      .campaign-level-card {
        border-radius: 14px;
        border: 1px solid rgba(148, 186, 255, 0.2);
        background: rgba(11, 21, 35, 0.78);
        overflow: hidden;
        display: grid;
      }

      .campaign-level-card.is-locked {
        opacity: 0.68;
      }

      .campaign-level-card.is-completed {
        border-color: rgba(110, 231, 183, 0.36);
      }

      .campaign-level-preview {
        min-height: 80px;
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        padding: 10px;
        background:
          radial-gradient(220px 120px at 15% -20%, rgba(43, 108, 238, 0.35), transparent),
          linear-gradient(140deg, rgba(24, 44, 78, 0.86), rgba(10, 18, 31, 0.95));
      }

      .campaign-level-index {
        font-size: 1.2rem;
        font-weight: 700;
        color: rgba(205, 221, 249, 0.8);
      }

      .campaign-level-body {
        display: grid;
        gap: 8px;
        padding: 10px;
      }

      .campaign-level-title {
        margin: 0;
        font-size: 1rem;
      }

      .campaign-level-meta {
        margin: 0;
        font-size: 0.77rem;
        letter-spacing: 0.03em;
        color: rgba(202, 217, 242, 0.84);
      }

      .campaign-level-source {
        margin: 0;
        font-size: 0.74rem;
        color: rgba(182, 198, 224, 0.8);
      }

      .campaign-level-action {
        width: 100%;
      }

      .campaign-mission-rail {
        display: grid;
        grid-auto-flow: column;
        grid-auto-columns: minmax(280px, 1fr);
        gap: 12px;
        overflow-x: auto;
        padding-bottom: 6px;
      }

      .campaign-mission-rail-card {
        border-radius: 14px;
        border: 1px solid rgba(148, 186, 255, 0.22);
        background: rgba(9, 19, 33, 0.8);
        overflow: hidden;
        min-height: 320px;
        display: grid;
        grid-template-rows: 1.1fr 1fr;
      }

      .campaign-mission-rail-card.is-locked {
        opacity: 0.68;
      }

      .campaign-mission-rail-card.is-completed {
        border-color: rgba(110, 231, 183, 0.35);
      }

      .campaign-mission-preview {
        display: flex;
        flex-direction: column;
        justify-content: flex-end;
        gap: 6px;
        padding: 12px;
        border-bottom: 1px solid rgba(148, 186, 255, 0.2);
        background: var(--campaign-mission-preview, linear-gradient(145deg, rgba(43, 108, 238, 0.45), rgba(16, 28, 54, 0.9)));
      }

      .campaign-mission-preview-title {
        margin: 0;
        font-size: 1.08rem;
      }

      .campaign-mission-preview-subtitle {
        margin: 0;
        font-size: 0.78rem;
        color: rgba(221, 235, 255, 0.86);
      }

      .campaign-mission-body {
        display: grid;
        align-content: space-between;
        gap: 10px;
        padding: 12px;
      }

      .campaign-mission-objective {
        margin: 0;
        font-size: 0.83rem;
        line-height: 1.42;
        color: rgba(211, 224, 246, 0.82);
      }

      .campaign-mission-meta {
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
      }

      .campaign-meta-chip {
        display: inline-flex;
        border-radius: 999px;
        padding: 3px 8px;
        font-size: 0.68rem;
        color: rgba(219, 233, 255, 0.85);
        background: rgba(48, 76, 125, 0.36);
        border: 1px solid rgba(145, 177, 230, 0.24);
      }

      .campaign-mission-action {
        width: 100%;
      }

      .campaign-footer {
        margin-top: 2px;
      }

      .campaign-footer-btn {
        min-width: 120px;
      }

      @media (max-width: 840px) {
        .campaign-stage-rail {
          grid-auto-columns: minmax(220px, 86vw);
        }

        .campaign-mission-rail {
          grid-auto-columns: minmax(240px, 86vw);
        }

        .campaign-meta-tree-row {
          grid-template-columns: repeat(3, minmax(250px, 84vw));
        }
      }

      @media (max-width: 620px) {
        .campaign-main-layout {
          width: min(94vw, 420px);
          gap: 24px;
        }

        .campaign-main-menu {
          padding: 12px;
          gap: 12px;
        }

        .campaign-level-grid {
          grid-template-columns: 1fr;
        }

        .campaign-profile-card {
          grid-template-columns: 1fr;
        }

        .mission-result-stats {
          grid-template-columns: repeat(2, minmax(0, 1fr));
        }

        .campaign-footer-btn {
          flex: 1 1 100%;
        }
      }

      .ui-button {
        appearance: none;
        border-radius: 10px;
        border: 1px solid transparent;
        color: var(--text);
        font-size: 0.92rem;
        font-weight: 600;
        line-height: 1.2;
        padding: 10px 12px;
        cursor: pointer;
        transition: transform 120ms ease, border-color 120ms ease, background-color 120ms ease;
      }

      .ui-button:hover {
        transform: translateY(-1px);
      }

      .ui-button:disabled {
        opacity: 0.45;
        cursor: not-allowed;
        transform: none;
      }

      .ui-button-primary {
        background: linear-gradient(135deg, var(--accent), var(--accent-strong));
        color: #05211d;
      }

      .ui-button-secondary {
        background: rgba(77, 101, 136, 0.35);
        border-color: rgba(165, 199, 255, 0.2);
      }

      .ui-button-ghost {
        background: rgba(82, 102, 132, 0.18);
        border-color: rgba(176, 201, 241, 0.15);
      }

      .ui-button-danger {
        background: rgba(248, 113, 113, 0.2);
        border-color: rgba(248, 113, 113, 0.55);
      }

      .ui-icon-button {
        width: fit-content;
        min-width: 0;
        padding: 8px 10px;
        display: inline-flex;
        align-items: center;
        gap: 8px;
      }

      .ui-icon {
        font-size: 1.1rem;
      }

      .ui-icon-label {
        font-size: 0.8rem;
        color: var(--text-muted);
      }

      .ui-hotkey-hint {
        font-size: 0.74rem;
        margin-left: 8px;
        padding: 1px 5px;
        border-radius: 5px;
        background: rgba(225, 236, 255, 0.2);
        border: 1px solid rgba(209, 226, 255, 0.3);
      }

      .badge,
      .ui-badge {
        font-size: 11px;
        background: rgba(95, 126, 173, 0.35);
        border: 1px solid rgba(165, 199, 255, 0.25);
        border-radius: 999px;
        padding: 3px 8px;
        margin-left: 8px;
        color: var(--text-muted);
      }

      .ui-divider {
        border: 0;
        border-top: 1px solid rgba(170, 199, 244, 0.2);
        margin: 12px 0;
      }

      .ui-scroll-area {
        overflow-y: auto;
        padding-right: 6px;
      }

      .ui-scroll-area::-webkit-scrollbar {
        width: 10px;
      }

      .ui-scroll-area::-webkit-scrollbar-track {
        background: rgba(129, 159, 208, 0.08);
        border-radius: 999px;
      }

      .ui-scroll-area::-webkit-scrollbar-thumb {
        background: rgba(156, 187, 240, 0.3);
        border-radius: 999px;
      }

      .ui-tooltip {
        color: var(--text-muted);
        font-size: 0.82rem;
      }

      .ui-tooltip-compact {
        font-size: 0.76rem;
      }

      .ui-tabs {
        display: grid;
        gap: 10px;
      }

      .ui-tab-list {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
      }

      .ui-tab {
        border: 1px solid rgba(171, 196, 238, 0.2);
        border-radius: 999px;
        background: rgba(95, 126, 173, 0.2);
        color: var(--text);
        padding: 7px 12px;
        cursor: pointer;
      }

      .ui-tab.is-active {
        background: rgba(45, 212, 191, 0.2);
        border-color: rgba(45, 212, 191, 0.5);
      }

      .ui-tab-body {
        display: grid;
        gap: 10px;
      }

      #debugIndicator {
        display: none;
        position: fixed;
        top: 14px;
        right: 14px;
        z-index: 30;
        border-radius: 999px;
        padding: 4px 9px;
        background: rgba(255, 77, 109, 0.14);
        border: 1px solid rgba(255, 125, 149, 0.34);
        color: rgba(255, 216, 223, 0.8);
        font-size: 0.68rem;
        font-weight: 700;
        letter-spacing: 0.1em;
        cursor: pointer;
        user-select: none;
        opacity: 0.72;
      }

      #debugIndicator.open {
        background: rgba(45, 212, 191, 0.18);
        border-color: rgba(45, 212, 191, 0.52);
        color: rgba(204, 251, 241, 0.92);
        opacity: 0.92;
      }

      #debugPanel {
        position: fixed;
        top: 0;
        right: 0;
        bottom: 0;
        width: min(420px, 92vw);
        z-index: 25;
        padding: 12px;
        transform: translateX(105%);
        transition: transform 180ms ease;
        pointer-events: none;
      }

      #debugPanel.open {
        transform: translateX(0);
        pointer-events: auto;
      }

      .debug-shell {
        height: calc(100% - 24px);
        overflow-y: auto;
      }

      .debug-toggle-row {
        display: grid;
        grid-template-columns: 1fr auto;
        gap: 12px;
        align-items: center;
        border: 1px solid rgba(176, 201, 241, 0.14);
        border-radius: 10px;
        padding: 8px 10px;
      }

      .debug-toggle-description {
        font-size: 0.75rem;
        color: var(--text-muted);
      }

      .debug-danger {
        border-radius: 10px;
        border: 1px solid rgba(248, 113, 113, 0.35);
        padding: 8px 10px;
        background: rgba(248, 113, 113, 0.08);
      }

      .debug-danger > summary {
        cursor: pointer;
        font-weight: 600;
      }

      .mission-hud {
        position: absolute;
        right: 12px;
        top: 12px;
        width: min(470px, calc(100vw - 24px));
        max-height: calc(100vh - 24px);
        overflow-y: auto;
      }

      .mission-command-shell {
        display: grid;
        gap: 10px;
        padding: 12px;
        background:
          radial-gradient(340px 180px at 18% -16%, rgba(43, 108, 238, 0.24), transparent),
          linear-gradient(165deg, rgba(10, 18, 30, 0.94), rgba(7, 13, 24, 0.95));
        border-color: rgba(133, 176, 255, 0.28);
        box-shadow: 0 20px 38px rgba(0, 0, 0, 0.48);
      }

      .mission-command-header {
        display: grid;
        gap: 4px;
        border: 1px solid rgba(140, 182, 255, 0.2);
        border-radius: 12px;
        padding: 10px;
        background: rgba(11, 21, 36, 0.76);
      }

      .mission-command-overline {
        margin: 0;
        font-size: 0.66rem;
        letter-spacing: 0.14em;
        text-transform: uppercase;
        color: rgba(196, 213, 241, 0.8);
      }

      .mission-command-title {
        margin: 0;
        font-size: 1rem;
      }

      .mission-command-objective {
        margin: 0;
        font-size: 0.78rem;
        line-height: 1.32;
        color: rgba(206, 221, 247, 0.84);
      }

      .mission-stats-grid {
        display: grid;
        grid-template-columns: repeat(2, minmax(0, 1fr));
        gap: 8px;
      }

      .mission-stat-tile {
        border-radius: 10px;
        border: 1px solid rgba(142, 180, 246, 0.2);
        background: rgba(11, 21, 35, 0.72);
        padding: 8px 9px;
        display: grid;
        gap: 3px;
      }

      .mission-stat-label {
        margin: 0;
        font-size: 0.63rem;
        letter-spacing: 0.1em;
        text-transform: uppercase;
        color: rgba(198, 216, 244, 0.75);
      }

      .mission-stat-value {
        margin: 0;
        font-size: 0.79rem;
        color: rgba(237, 244, 255, 0.95);
      }

      .mission-focus-card,
      .mission-feed-card,
      .mission-skill-card {
        border-radius: 11px;
        border: 1px solid rgba(142, 180, 246, 0.2);
        background: rgba(10, 21, 35, 0.75);
        padding: 9px;
        display: grid;
        gap: 7px;
      }

      .mission-block-label {
        margin: 0;
        font-size: 0.65rem;
        letter-spacing: 0.1em;
        text-transform: uppercase;
        color: rgba(193, 212, 241, 0.76);
      }

      .mission-focus-main,
      .mission-focus-sub {
        margin: 0;
        font-size: 0.79rem;
      }

      .mission-focus-sub {
        color: rgba(204, 221, 247, 0.84);
      }

      .mission-bonus-row {
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
      }

      .mission-bonus-chip {
        margin: 0;
        border-radius: 999px;
        border: 1px solid rgba(141, 179, 245, 0.28);
        background: rgba(41, 71, 122, 0.34);
        padding: 3px 8px;
        font-size: 0.68rem;
        color: rgba(213, 228, 252, 0.88);
      }

      .mission-feed-grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: 8px;
      }

      .mission-event-feed,
      .mission-wave-preview-list {
        display: grid;
        gap: 6px;
      }

      .mission-event-row,
      .mission-preview-row {
        border-radius: 8px;
        border: 1px solid rgba(140, 179, 246, 0.2);
        background: rgba(13, 24, 41, 0.72);
        padding: 6px 8px;
        font-size: 0.74rem;
        line-height: 1.3;
      }

      .mission-event-warning {
        border-color: rgba(245, 158, 11, 0.4);
        background: rgba(66, 44, 13, 0.5);
      }

      .mission-event-success {
        border-color: rgba(74, 222, 128, 0.35);
        background: rgba(17, 50, 34, 0.5);
      }

      .mission-event-empty,
      .mission-preview-empty {
        margin: 0;
        font-size: 0.72rem;
        opacity: 0.78;
      }

      .mission-skill-target-label {
        margin: 0;
        font-size: 0.72rem;
        opacity: 0.86;
      }

      .mission-skill-list .mission-skill-row {
        border-radius: 9px;
        border: 1px solid rgba(139, 178, 243, 0.2);
        background: rgba(14, 25, 41, 0.72);
        padding: 7px 8px;
      }

      .mission-balance-debug {
        margin: 0;
        font-size: 0.69rem;
        color: rgba(191, 210, 240, 0.86);
      }

      .hud-mission-header {
        display: grid;
        gap: 3px;
      }

      .hud-mission-overline {
        margin: 0;
        font-size: 0.64rem;
        letter-spacing: 0.16em;
        text-transform: uppercase;
        color: rgba(198, 216, 244, 0.75);
      }

      .hud-mission-title {
        margin: 0;
        font-size: 1.02rem;
      }

      .hud-mission-objective {
        margin: 0;
        font-size: 0.76rem;
        color: rgba(204, 223, 252, 0.85);
      }

      .hud-overlay-strip {
        display: grid;
        grid-template-columns: repeat(3, minmax(0, 1fr));
        gap: 6px;
      }

      .hud-overlay-toggle {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 8px;
        border: 1px solid rgba(148, 187, 255, 0.34);
        background: rgba(16, 28, 48, 0.74);
        color: var(--text);
        border-radius: 10px;
        padding: 5px 8px;
        font-size: 0.68rem;
        letter-spacing: 0.08em;
        text-transform: uppercase;
      }

      .hud-overlay-toggle.active {
        border-color: rgba(45, 212, 191, 0.72);
        background: rgba(18, 88, 80, 0.7);
      }

      .hud-overlay-toggle-label {
        font-size: 0.66rem;
      }

      .hud-overlay-toggle-state {
        border-radius: 999px;
        border: 1px solid rgba(152, 191, 255, 0.32);
        background: rgba(17, 30, 49, 0.78);
        padding: 1px 6px;
        font-size: 0.62rem;
        color: rgba(199, 217, 244, 0.78);
      }

      .hud-overlay-toggle-state.on {
        border-color: rgba(45, 212, 191, 0.7);
        color: rgba(202, 251, 241, 0.95);
      }

      .hud-zone {
        border-radius: 12px;
        border: 1px solid rgba(138, 183, 250, 0.22);
        background: rgba(10, 19, 33, 0.74);
        padding: 10px;
        display: grid;
        gap: 9px;
      }

      .hud-zone-head {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 8px;
      }

      .hud-zone-label {
        margin: 0;
        font-size: 0.63rem;
        letter-spacing: 0.13em;
        text-transform: uppercase;
        color: rgba(194, 213, 242, 0.78);
      }

      .hud-threat-phase,
      .hud-context-mode {
        margin: 0;
        font-size: 0.74rem;
        color: rgba(206, 222, 247, 0.86);
      }

      .hud-threat-meter {
        display: grid;
        grid-template-columns: 1fr auto;
        gap: 8px;
        align-items: center;
      }

      .hud-wave-label {
        margin: 0;
        font-size: 1rem;
        font-weight: 700;
      }

      .hud-countdown {
        margin: 0;
        font-size: 1.46rem;
        line-height: 1;
        letter-spacing: 0.03em;
        color: #d8e8ff;
      }

      .hud-countdown.urgent {
        color: #fca5a5;
      }

      .hud-countdown.live {
        color: #67e8f9;
      }

      .hud-countdown-hint {
        margin: -4px 0 0;
        font-size: 0.7rem;
        color: rgba(190, 211, 242, 0.74);
      }

      .hud-threat-row,
      .hud-modifier-row,
      .hud-global-badges,
      .hud-territory-badges {
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
      }

      .hud-threat-chip {
        display: grid;
        grid-template-columns: auto 1fr auto;
        gap: 6px;
        align-items: center;
        min-width: 0;
        border-radius: 999px;
        border: 1px solid rgba(150, 189, 255, 0.24);
        background: rgba(16, 30, 50, 0.78);
        padding: 4px 10px;
        font-size: 0.74rem;
      }

      .hud-threat-chip.tone-info {
        border-color: rgba(96, 165, 250, 0.38);
        background: rgba(21, 45, 77, 0.7);
      }

      .hud-threat-chip.tone-warning {
        border-color: rgba(251, 191, 36, 0.44);
        background: rgba(80, 54, 16, 0.62);
      }

      .hud-threat-chip.tone-danger {
        border-color: rgba(248, 113, 113, 0.58);
        background: rgba(94, 33, 42, 0.66);
      }

      .hud-chip-icon {
        font-weight: 700;
      }

      .hud-chip-text {
        min-width: 0;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }

      .hud-chip-eta {
        color: rgba(210, 227, 252, 0.75);
      }

      .hud-chip-eta.urgent {
        color: rgba(254, 226, 226, 0.95);
      }

      .hud-badge {
        display: inline-flex;
        align-items: center;
        gap: 5px;
        border-radius: 999px;
        border: 1px solid rgba(149, 188, 255, 0.24);
        background: rgba(18, 31, 52, 0.78);
        padding: 3px 9px;
        font-size: 0.68rem;
      }

      .hud-badge.tone-success {
        border-color: rgba(74, 222, 128, 0.38);
        background: rgba(19, 56, 40, 0.6);
      }

      .hud-badge.tone-warning {
        border-color: rgba(251, 191, 36, 0.42);
        background: rgba(71, 46, 16, 0.58);
      }

      .hud-objective-head {
        display: flex;
        justify-content: space-between;
        align-items: baseline;
        gap: 8px;
      }

      .hud-progress-label,
      .hud-progress-detail,
      .hud-territory-title {
        margin: 0;
        font-size: 0.79rem;
      }

      .hud-progress-percent {
        margin: 0;
        font-size: 0.76rem;
        font-weight: 700;
        color: rgba(188, 249, 236, 0.95);
      }

      .hud-progress-track {
        height: 10px;
        border-radius: 999px;
        border: 1px solid rgba(140, 179, 245, 0.28);
        background: rgba(8, 17, 30, 0.95);
        overflow: hidden;
      }

      .hud-progress-fill {
        height: 100%;
        width: 0%;
        border-radius: 999px;
        background: linear-gradient(90deg, rgba(14, 165, 233, 0.98), rgba(45, 212, 191, 0.98));
        box-shadow: 0 0 10px rgba(45, 212, 191, 0.45);
      }

      .hud-skill-row {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(95px, 1fr));
        gap: 6px;
      }

      .hud-skill-chip {
        border-radius: 10px;
        border: 1px solid rgba(142, 181, 248, 0.28);
        background: rgba(13, 24, 42, 0.78);
        color: var(--text);
        padding: 6px;
        display: grid;
        gap: 2px;
        text-align: left;
      }

      .hud-skill-chip:disabled {
        opacity: 0.58;
      }

      .hud-skill-hotkey {
        font-size: 0.66rem;
        color: rgba(191, 214, 246, 0.76);
      }

      .hud-skill-name {
        font-size: 0.72rem;
        font-weight: 600;
      }

      .hud-skill-cd {
        font-size: 0.66rem;
        color: rgba(203, 221, 250, 0.78);
      }

      .hud-context-zone {
        min-height: 160px;
        overflow-y: auto;
      }

      .hud-context-content {
        display: grid;
        gap: 5px;
      }

      .hud-context-row {
        display: grid;
        grid-template-columns: 1fr auto;
        gap: 10px;
        font-size: 0.78rem;
        line-height: 1.35;
      }

      .hud-context-label {
        color: rgba(195, 216, 246, 0.8);
      }

      .hud-context-value {
        color: rgba(232, 242, 255, 0.95);
        font-weight: 600;
      }

      .hud-context-badges {
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
        margin-top: 2px;
      }

      .hud-context-hint {
        margin: 4px 0 0;
        font-size: 0.73rem;
        line-height: 1.35;
        color: rgba(193, 214, 246, 0.78);
      }

      .hud-log-drawer {
        border-top: 1px solid rgba(144, 185, 255, 0.18);
        padding-top: 6px;
      }

      .hud-log-drawer.hidden {
        display: none;
      }

      .hud-log-drawer > summary {
        cursor: pointer;
        font-size: 0.7rem;
        color: rgba(196, 213, 240, 0.86);
      }

      .hud-log-list {
        margin-top: 6px;
        display: grid;
        gap: 4px;
      }

      .hud-log-row {
        margin: 0;
        font-size: 0.72rem;
        line-height: 1.35;
        border-radius: 8px;
        border: 1px solid rgba(137, 178, 246, 0.2);
        background: rgba(12, 23, 40, 0.7);
        padding: 4px 6px;
      }

      .hud-row-empty {
        margin: 0;
        font-size: 0.73rem;
        color: rgba(197, 214, 242, 0.75);
      }

      .hud-map-overlays {
        position: fixed;
        inset: 0;
        pointer-events: none;
        z-index: 18;
      }

      .hud-overlay-layer {
        position: absolute;
        inset: 0;
        pointer-events: none;
      }

      .hud-overlay-regen {
        position: absolute;
        transform: translate(-50%, -50%);
        font-size: 0.68rem;
        font-weight: 600;
        color: rgba(203, 246, 238, 0.92);
        text-shadow: 0 1px 4px rgba(0, 0, 0, 0.7);
        white-space: nowrap;
      }

      .hud-overlay-capture {
        position: absolute;
        width: 84px;
        height: 84px;
      }

      .hud-overlay-capture-pressure,
      .hud-overlay-capture-breach {
        position: absolute;
        inset: 0;
        border-radius: 50%;
      }

      .hud-overlay-capture-pressure {
        opacity: 0.72;
        background: conic-gradient(
          var(--capture-color) calc(var(--capture-pressure, 0) * 1turn),
          rgba(104, 124, 161, 0.16) 0
        );
        -webkit-mask: radial-gradient(farthest-side, transparent calc(100% - 5px), #000 0);
        mask: radial-gradient(farthest-side, transparent calc(100% - 5px), #000 0);
      }

      .hud-overlay-capture-breach {
        inset: 8px;
        opacity: 0.95;
        background: conic-gradient(
          var(--capture-color) calc(var(--capture-breach, 0) * 1turn),
          rgba(120, 135, 160, 0.2) 0
        );
        -webkit-mask: radial-gradient(farthest-side, transparent calc(100% - 4px), #000 0);
        mask: radial-gradient(farthest-side, transparent calc(100% - 4px), #000 0);
      }

      .hud-overlay-capture-label {
        position: absolute;
        left: 50%;
        top: calc(100% + 3px);
        transform: translateX(-50%);
        font-size: 0.61rem;
        font-weight: 700;
        letter-spacing: 0.05em;
        text-transform: uppercase;
        color: rgba(224, 238, 255, 0.86);
        text-shadow: 0 1px 3px rgba(0, 0, 0, 0.65);
      }

      .hud-overlay-capture.is-contested .hud-overlay-capture-label {
        color: rgba(248, 228, 188, 0.92);
      }

      .hud-overlay-capture.is-breaching .hud-overlay-capture-pressure,
      .hud-overlay-capture.is-breaching .hud-overlay-capture-breach {
        animation: capturePulse 0.9s ease-in-out infinite;
      }

      .hud-overlay-capture.is-breaching .hud-overlay-capture-label {
        color: rgba(255, 193, 166, 0.95);
      }

      @keyframes capturePulse {
        0% {
          transform: scale(1);
          opacity: 0.86;
        }
        50% {
          transform: scale(1.03);
          opacity: 1;
        }
        100% {
          transform: scale(1);
          opacity: 0.86;
        }
      }

      .hud-overlay-cluster {
        position: absolute;
        width: 76px;
        height: 76px;
        border-radius: 50%;
        border: 2px solid rgba(45, 212, 191, 0.34);
        box-shadow: 0 0 14px rgba(45, 212, 191, 0.28);
      }

      .hud-toast-root {
        position: fixed;
        right: 14px;
        bottom: 14px;
        z-index: 26;
        width: min(360px, calc(100vw - 28px));
        display: grid;
        gap: 8px;
        pointer-events: none;
      }

      .hud-toast {
        border-radius: 10px;
        border: 1px solid rgba(150, 190, 255, 0.26);
        background: rgba(9, 17, 30, 0.9);
        box-shadow: 0 10px 24px rgba(0, 0, 0, 0.35);
        padding: 8px 10px;
        transition: opacity 180ms ease, transform 180ms ease;
      }

      .hud-toast.leaving {
        opacity: 0;
        transform: translateY(6px);
      }

      .hud-toast.tone-warning {
        border-color: rgba(251, 191, 36, 0.4);
      }

      .hud-toast.tone-success {
        border-color: rgba(74, 222, 128, 0.38);
      }

      .hud-toast.tone-danger {
        border-color: rgba(248, 113, 113, 0.45);
      }

      .hud-toast-title,
      .hud-toast-body {
        margin: 0;
      }

      .hud-toast-title {
        font-size: 0.76rem;
        font-weight: 700;
      }

      .hud-toast-body {
        margin-top: 2px;
        font-size: 0.72rem;
        color: rgba(208, 225, 251, 0.84);
      }

      .gameplay-hud {
        position: fixed;
        inset: 0;
        pointer-events: none;
      }

      .hud-glass-card {
        background: rgba(10, 18, 32, 0.88);
        border: 1px solid rgba(148, 188, 250, 0.16);
        border-radius: 12px;
        box-shadow: 0 10px 22px rgba(0, 0, 0, 0.34);
      }

      .hud-top-bar {
        position: fixed;
        top: 10px;
        left: 10px;
        right: 10px;
        min-height: 0;
        display: flex;
        gap: 8px;
        align-items: center;
        justify-content: space-between;
        pointer-events: none;
      }

      .hud-top-cluster {
        display: flex;
        align-items: center;
        gap: 8px;
        min-width: 0;
        pointer-events: auto;
        background: rgba(10, 18, 32, 0.88);
        border: 1px solid rgba(148, 188, 250, 0.16);
        border-radius: 10px;
        padding: 7px 9px;
      }

      .hud-top-left {
        justify-content: flex-start;
        flex: 0 0 auto;
        max-width: min(56vw, 640px);
      }

      .hud-top-center {
        justify-content: center;
        flex: 0 0 auto;
      }

      .hud-top-right {
        justify-content: flex-end;
        flex: 0 0 auto;
      }

      .hud-top-mission-title {
        margin: 0;
        font-size: 0.7rem;
        letter-spacing: 0.1em;
        text-transform: uppercase;
        color: rgba(206, 222, 247, 0.82);
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        max-width: 24ch;
      }

      .hud-top-wave {
        margin: 0;
        font-size: 0.78rem;
        font-weight: 600;
      }

      .hud-state-badge {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        border-radius: 999px;
        border: 1px solid rgba(143, 184, 247, 0.28);
        padding: 2px 8px;
        font-size: 0.64rem;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        color: rgba(207, 226, 251, 0.9);
        background: rgba(23, 37, 60, 0.86);
      }

      .hud-state-badge.live {
        border-color: rgba(248, 113, 113, 0.42);
        background: rgba(83, 31, 42, 0.8);
      }

      .hud-state-badge.prep {
        border-color: rgba(56, 189, 248, 0.44);
        background: rgba(20, 51, 82, 0.8);
      }

      .hud-state-badge.complete {
        border-color: rgba(74, 222, 128, 0.42);
        background: rgba(20, 64, 47, 0.8);
      }

      .hud-top-countdown {
        margin: 0;
        font-size: 0.76rem;
        color: rgba(189, 247, 236, 0.94);
      }

      .hidden {
        display: none !important;
      }

      .hud-top-metric {
        display: grid;
        gap: 2px;
        text-align: center;
        min-width: 58px;
      }

      .hud-top-metric-label {
        margin: 0;
        font-size: 0.6rem;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        color: rgba(196, 214, 240, 0.78);
      }

      .hud-top-metric-value {
        margin: 0;
        font-size: 0.78rem;
        font-weight: 600;
      }

      .hud-action-btn,
      .hud-speed-btn {
        border: 1px solid rgba(143, 184, 247, 0.24);
        border-radius: 8px;
        background: rgba(17, 30, 49, 0.82);
        color: var(--text);
        font-size: 0.69rem;
        padding: 5px 9px;
        cursor: pointer;
      }

      .hud-speed-group {
        display: inline-flex;
        gap: 6px;
      }

      .hud-speed-btn.active {
        border-color: rgba(45, 212, 191, 0.48);
        background: rgba(18, 82, 74, 0.82);
      }

      .hud-overlay-mini-group {
        display: inline-flex;
        gap: 4px;
      }

      .hud-overlay-mini-btn {
        border: 1px solid rgba(143, 184, 247, 0.24);
        border-radius: 8px;
        background: rgba(17, 30, 49, 0.82);
        color: var(--text);
        font-size: 0.62rem;
        font-weight: 700;
        width: 26px;
        height: 24px;
        padding: 0;
        cursor: pointer;
      }

      .hud-overlay-mini-btn.active {
        border-color: rgba(45, 212, 191, 0.48);
        background: rgba(18, 82, 74, 0.82);
      }

      .hud-wave-intel {
        position: fixed;
        top: 76px;
        right: 10px;
        display: flex;
        align-items: stretch;
        pointer-events: auto;
      }

      .hud-wave-tab {
        writing-mode: vertical-rl;
        text-orientation: mixed;
        border-radius: 10px 0 0 10px;
        border: 1px solid rgba(143, 184, 247, 0.2);
        border-right: none;
        background: rgba(10, 18, 32, 0.9);
        color: var(--text);
        font-size: 0.64rem;
        letter-spacing: 0.05em;
        padding: 8px 6px;
        min-height: 130px;
        cursor: pointer;
      }

      .hud-wave-panel {
        width: min(290px, 58vw);
        padding: 10px;
        display: grid;
        gap: 12px;
        background: rgba(10, 18, 32, 0.88);
        border: 1px solid rgba(148, 188, 250, 0.16);
        border-radius: 0 12px 12px 12px;
      }

      .hud-wave-intel.is-collapsed .hud-wave-panel {
        display: none;
      }

      .hud-wave-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 10px;
      }

      .hud-wave-title {
        margin: 0;
        font-size: 0.8rem;
        font-weight: 600;
      }

      .hud-wave-section {
        display: grid;
        gap: 7px;
      }

      .hud-wave-section-title {
        margin: 0;
        font-size: 0.64rem;
        letter-spacing: 0.1em;
        text-transform: uppercase;
        color: rgba(196, 214, 240, 0.78);
      }

      .hud-enemy-composition {
        display: grid;
        grid-template-columns: repeat(5, minmax(0, 1fr));
        gap: 6px;
      }

      .hud-enemy-item {
        border-radius: 9px;
        border: 1px solid rgba(143, 184, 247, 0.18);
        background: rgba(17, 30, 49, 0.78);
        padding: 6px 5px;
        display: grid;
        place-items: center;
        gap: 2px;
      }

      .hud-enemy-icon {
        font-size: 0.86rem;
        line-height: 1;
      }

      .hud-enemy-count {
        font-size: 0.67rem;
        color: rgba(208, 225, 251, 0.88);
      }

      .hud-modifier-list {
        display: grid;
        gap: 5px;
      }

      .hud-modifier-item {
        margin: 0;
        font-size: 0.72rem;
        line-height: 1.32;
      }

      .hud-boss-preview {
        margin: 0;
        font-size: 0.73rem;
        color: rgba(205, 223, 252, 0.9);
      }

      .hud-objective-card {
        position: fixed;
        left: 10px;
        bottom: 10px;
        width: min(310px, calc(100vw - 20px));
        padding: 11px;
        display: grid;
        gap: 10px;
        pointer-events: auto;
        background: rgba(10, 18, 32, 0.88);
        border: 1px solid rgba(148, 188, 250, 0.16);
        border-radius: 12px;
      }

      .hud-card-title {
        margin: 0;
        font-size: 0.77rem;
        font-weight: 600;
        line-height: 1.32;
      }

      .hud-progress-track {
        height: 8px;
        border-radius: 999px;
        border: 1px solid rgba(140, 179, 245, 0.24);
        background: rgba(8, 17, 30, 0.9);
        overflow: hidden;
      }

      .hud-progress-fill {
        height: 100%;
        width: 0%;
        border-radius: 999px;
        background: linear-gradient(90deg, rgba(14, 165, 233, 0.95), rgba(45, 212, 191, 0.95));
      }

      .hud-objective-meta {
        margin: 0;
        font-size: 0.72rem;
        color: rgba(200, 217, 243, 0.86);
      }

      .hud-objective-meta.active {
        color: rgba(167, 243, 208, 0.94);
      }

      .hud-objective-meta.inactive {
        color: rgba(224, 210, 204, 0.84);
      }

      .hud-tower-inspector {
        position: fixed;
        right: 10px;
        bottom: 10px;
        width: min(320px, calc(100vw - 20px));
        padding: 11px;
        display: grid;
        gap: 10px;
        pointer-events: auto;
        background: rgba(10, 18, 32, 0.88);
        border: 1px solid rgba(148, 188, 250, 0.16);
        border-radius: 12px;
      }

      .hud-inspector-rows {
        display: grid;
        gap: 7px;
      }

      .hud-inspector-row {
        display: grid;
        grid-template-columns: 1fr auto;
        gap: 10px;
        align-items: center;
      }

      .hud-inspector-label {
        font-size: 0.68rem;
        color: rgba(196, 214, 240, 0.82);
      }

      .hud-inspector-value {
        font-size: 0.72rem;
        color: rgba(231, 240, 253, 0.95);
        text-align: right;
      }

      .hud-inspector-hint {
        margin: 0;
        font-size: 0.68rem;
        color: rgba(196, 228, 255, 0.78);
      }

      .hud-row-empty {
        margin: 0;
        font-size: 0.7rem;
        color: rgba(197, 214, 242, 0.75);
      }

      .mission-overlay-panel {
        width: min(92vw, 640px);
      }

      .centered-modal {
        align-items: center;
        justify-items: center;
      }

      .mission-pause-shell {
        width: min(92vw, 560px);
        display: grid;
        gap: 10px;
        background:
          radial-gradient(360px 200px at 20% -18%, rgba(43, 108, 238, 0.18), transparent),
          linear-gradient(165deg, rgba(10, 20, 34, 0.95), rgba(8, 15, 27, 0.96));
      }

      .mission-pause-hero {
        border-radius: 12px;
        border: 1px solid rgba(142, 180, 246, 0.24);
        background: rgba(11, 21, 35, 0.78);
        padding: 10px;
        display: grid;
        grid-template-columns: auto 1fr;
        gap: 10px;
        align-items: center;
      }

      .mission-pause-emblem {
        width: 40px;
        height: 40px;
        border-radius: 12px;
        display: grid;
        place-items: center;
        font-size: 0.92rem;
        font-weight: 800;
        letter-spacing: 0.08em;
        color: #f8fbff;
        background: linear-gradient(150deg, rgba(43, 108, 238, 0.92), rgba(18, 45, 106, 0.95));
      }

      .mission-pause-title {
        margin: 0;
        font-size: 1rem;
      }

      .mission-pause-subtitle {
        margin: 3px 0 0;
        font-size: 0.79rem;
        color: rgba(206, 221, 247, 0.84);
      }

      .mission-pause-summary {
        border-radius: 11px;
        border: 1px solid rgba(142, 180, 246, 0.22);
        background: rgba(10, 20, 34, 0.76);
        padding: 9px;
        display: grid;
        gap: 5px;
      }

      .mission-pause-actions {
        display: grid;
        gap: 8px;
      }

      .mission-pause-action {
        width: 100%;
        min-height: 44px;
        border-radius: 10px;
        font-size: 0.84rem;
        letter-spacing: 0.04em;
        text-transform: uppercase;
        font-weight: 700;
      }

      .mission-pause-action.is-primary {
        box-shadow: 0 12px 24px rgba(19, 64, 168, 0.42);
      }

      .mission-result-shell {
        width: min(92vw, 760px);
        display: grid;
        gap: 10px;
        background:
          radial-gradient(420px 220px at 16% -14%, rgba(43, 108, 238, 0.2), transparent),
          linear-gradient(160deg, rgba(10, 20, 34, 0.95), rgba(7, 14, 26, 0.96));
      }

      .mission-result-shell.is-victory {
        border-color: rgba(74, 222, 128, 0.35);
      }

      .mission-result-shell.is-defeat {
        border-color: rgba(248, 113, 113, 0.35);
      }

      .mission-result-hero {
        border-radius: 12px;
        border: 1px solid rgba(143, 181, 248, 0.24);
        background: rgba(11, 21, 35, 0.78);
        padding: 10px;
        display: grid;
        grid-template-columns: auto 1fr;
        gap: 10px;
        align-items: center;
      }

      .mission-result-emblem {
        width: 42px;
        height: 42px;
        border-radius: 12px;
        display: grid;
        place-items: center;
        font-size: 1rem;
        font-weight: 800;
        letter-spacing: 0.04em;
        color: #f8fbff;
        background: linear-gradient(150deg, rgba(43, 108, 238, 0.9), rgba(18, 45, 106, 0.95));
      }

      .mission-result-shell.is-victory .mission-result-emblem {
        background: linear-gradient(150deg, rgba(34, 197, 94, 0.9), rgba(13, 85, 48, 0.95));
      }

      .mission-result-shell.is-defeat .mission-result-emblem {
        background: linear-gradient(150deg, rgba(239, 68, 68, 0.92), rgba(120, 28, 28, 0.95));
      }

      .mission-result-title {
        margin: 0;
        font-size: 1.04rem;
      }

      .mission-result-subtitle {
        margin: 3px 0 0;
        font-size: 0.79rem;
        color: rgba(209, 224, 248, 0.84);
      }

      .mission-result-stats {
        display: grid;
        grid-template-columns: repeat(4, minmax(0, 1fr));
        gap: 8px;
      }

      .mission-result-stat {
        border-radius: 10px;
        border: 1px solid rgba(142, 180, 246, 0.2);
        background: rgba(11, 21, 35, 0.76);
        padding: 8px;
        display: grid;
        gap: 3px;
      }

      .mission-result-stat-label {
        margin: 0;
        font-size: 0.63rem;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        color: rgba(191, 210, 240, 0.75);
      }

      .mission-result-stat-value {
        margin: 0;
        font-size: 0.83rem;
        color: rgba(235, 244, 255, 0.96);
      }

      .mission-result-notes {
        border-radius: 10px;
        border: 1px solid rgba(142, 180, 246, 0.2);
        background: rgba(10, 20, 34, 0.78);
        padding: 9px;
        display: grid;
        gap: 5px;
      }

      .mission-result-note-line {
        margin: 0;
        font-size: 0.8rem;
        line-height: 1.34;
        color: rgba(211, 226, 251, 0.84);
      }

      .mission-result-actions {
        margin-top: 2px;
      }

      .pause-panel {
        width: min(92vw, 560px);
      }

      .top-pause-btn {
        min-width: 108px;
        border-radius: 999px;
        border-color: rgba(155, 190, 252, 0.28);
        background: rgba(20, 34, 56, 0.78);
      }

      .world-tooltip-overlay {
        position: fixed;
        inset: 0;
        z-index: 22;
        pointer-events: none;
      }

      .world-tooltip {
        position: absolute;
        min-width: 180px;
        max-width: 320px;
        background: rgba(9, 15, 26, 0.92);
        border: 1px solid rgba(156, 187, 240, 0.45);
        border-radius: 12px;
        box-shadow: 0 16px 34px rgba(0, 0, 0, 0.42);
        padding: 10px 12px;
        color: var(--text);
        transition: opacity 110ms ease;
      }

      .world-tooltip-title {
        font-weight: 700;
        margin-bottom: 4px;
      }

      .world-tooltip-main {
        font-size: 0.9rem;
        color: var(--text-muted);
        margin-bottom: 4px;
      }

      .world-tooltip-row {
        display: grid;
        grid-template-columns: auto 1fr;
        gap: 10px;
        margin-top: 2px;
        font-size: 0.82rem;
      }

      .world-tooltip-label {
        color: var(--text-muted);
      }

      .world-tooltip-value {
        text-align: right;
      }

      .world-tooltip-desc {
        margin: 4px 0;
        font-size: 0.82rem;
        color: var(--text-muted);
      }

      .world-tooltip-chips {
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
        margin: 5px 0 2px;
      }

      .world-tooltip-chip {
        border-radius: 999px;
        border: 1px solid rgba(165, 199, 255, 0.35);
        background: rgba(95, 126, 173, 0.26);
        padding: 2px 7px;
        font-size: 0.74rem;
      }

      select,
      input[type="text"] {
        background: rgba(75, 97, 131, 0.35);
        color: var(--text);
        border: 1px solid rgba(176, 201, 241, 0.35);
        border-radius: 8px;
        padding: 6px 8px;
      }

      @media (max-width: 960px), (max-height: 760px) {
        .panel,
        .ui-panel {
          padding: 14px;
          border-radius: 12px;
        }

        .centered {
          align-items: start;
          padding-top: 12px;
        }

        .splash-shell {
          padding: 14px 16px 20px;
          grid-template-rows: 1fr auto;
        }

        .splash-hero {
          width: min(390px, 100%);
          gap: 18px;
        }

        .splash-emblem-wrap {
          width: 132px;
          height: 132px;
        }

        .hud-top-bar {
          justify-content: space-between;
          align-items: center;
          gap: 8px;
          top: 8px;
          left: 8px;
          right: 8px;
          min-height: 0;
        }

        .hud-top-left {
          justify-content: flex-start;
          gap: 6px;
          min-width: 0;
          overflow: hidden;
          flex: 1 1 auto;
        }

        .hud-top-center {
          justify-content: center;
          gap: 6px;
          flex: 0 0 auto;
        }

        .hud-top-right {
          justify-content: flex-end;
          gap: 6px;
          flex: 0 0 auto;
          max-width: 50%;
          overflow: hidden;
        }

        .hud-top-mission-title {
          max-width: 16ch;
          font-size: 0.64rem;
        }

        .hud-top-countdown {
          display: none;
        }

        .hud-top-metric {
          display: flex;
          align-items: baseline;
          gap: 3px;
          min-width: auto;
        }

        .hud-top-metric-label {
          display: none;
        }

        .hud-top-metric-value {
          font-size: 0.72rem;
        }

        .hud-action-btn,
        .hud-overlay-mini-btn,
        .hud-speed-btn {
          padding: 4px 7px;
          font-size: 0.64rem;
        }

        .hud-overlay-mini-btn {
          width: 24px;
          height: 22px;
          padding: 0;
          font-size: 0.58rem;
        }

        .hud-wave-intel {
          top: 62px;
          right: 8px;
        }

        .hud-wave-panel {
          width: min(250px, 70vw);
        }

        .hud-objective-card {
          left: 8px;
          bottom: 8px;
          width: min(280px, calc(100vw - 16px));
        }

        .hud-tower-inspector {
          right: 8px;
          bottom: 8px;
          width: min(280px, calc(100vw - 16px));
        }
      }

      @media (max-width: 860px) {
        .hud-objective-card,
        .hud-tower-inspector {
          width: min(240px, calc(50vw - 12px));
        }
      }

      @media (max-width: 640px) {
        .hud-objective-card {
          left: 8px;
          right: 8px;
          bottom: 8px;
          width: auto;
        }

        .hud-tower-inspector {
          left: 8px;
          right: 8px;
          bottom: 126px;
          width: auto;
        }
      }

      @keyframes splashPulse {
        0%,
        100% {
          opacity: 0.54;
        }
        50% {
          opacity: 1;
        }
      }
    </style>
  </head>
  <body>
    <div id="debugIndicator">DEBUG</div>
    <div id="debugPanel"></div>
    <div id="screenRoot"></div>
    <canvas id="gameCanvas"></canvas>
    <script type="module" src="/src/main.ts"></script>
  </body>
</html>
